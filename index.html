<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <link rel="stylesheet" href="styles.css" /> -->
    <title>Document</title>
  </head>
  <style>
    .gameContainer {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
      padding: 0;
    }
    .cell {
      width: 50px;
      border: 2px solid black;
      height: 50px;
      align-content: center;
      text-align: center;
    }
    .cell:hover {
      border-radius: 10px;
    }
    .king {
      background-color: gold;
    }
    .queen {
      background-color: powderblue;
      /* background: url("./Queen2.png"); */
      object-fit: fill;
    }
    .horse {
      background-color: red;
    }
    .bishop {
      background-color: black;
    }
    .castle {
      background-color: gray;
    }
    .pawn {
      background-color: teal;
    }
  </style>
  <body>
    <div id="gameContainer" class="gameContainer"></div>
    <script>
      let currentPiece = "";
      let prevId = "";
      let pieces = ["queen", "king", "horse", "bishop", "castle", "pawn"];

      function clickedOn(id) {
        let AllButOne = pieces.filter((item) => item !== currentPiece);
        const myElement = document.getElementById(id);
        const myOldElement = document.getElementById(prevId);
        console.log(AllButOne);
        console.log(currentPiece);
        console.log(id);
        //Detects the piece you just clicked on
        for (let i = 0; i < pieces.length; i++) {
          if (myElement.classList.contains(`${pieces[i]}`)) {
            currentPiece = `${pieces[i]}`;
            //Saves the previous elements id
            prevId = id;
            myElement.style.border = "2px solid yellow";
          }
        }
        AvaliableMoves(myOldElement, myElement);
        //if its not empty it will do nothing
        for (let i = 0; i < AllButOne.length; i++) {
          if (myElement.classList.contains(AllButOne[i])) {
            myOldElement.style.border = "2px solid black";
            return;
          }
        }
        //Moving the piece if the spot is empty
        if (!myElement.classList.contains(`${currentPiece}`)) {
          myOldElement.style.border = "2px solid black";
          myOldElement.classList.remove(`${currentPiece}`);
          myElement.classList.add(`${currentPiece}`);
          currentPiece = ``;
        }
      }
      function AvaliableMoves(myOldElement, myElement) {
        console.log("Avaliable moves");
        // console.log("MyOldElement in AvaliableMoves: ", myOldElement);
        // console.log("MyElement in AvaliableMoves: ", myElement);
        //Possible moves for queen
        if (myElement.classList.contains("queen")) {
          for (let i = 0; i < Number(myElement.id); i++) {
            const possibleElement = document.getElementById(
              `${i * 9 + Number(myElement.id)}`
            );
            possibleElement.style.border = "2px solid blue";
          }
          for (let i = 0; i < Number(myElement.id); i++) {
            const possibleElement = document.getElementById(
              `${i * 7 + Number(myElement.id)}`
            );
            possibleElement.style.border = "2px solid blue";
          }
        }
      }

      function makeBoard() {
        const BOARD_WIDTH = 8;

        const container = document.getElementById("gameContainer");
        container.innerHTML = ""; // clear old board

        for (let row = 0; row < BOARD_WIDTH; row++) {
          for (let col = 0; col < BOARD_WIDTH; col++) {
            container.innerHTML += `
        <div id="${row * BOARD_WIDTH + col}"
             class="cell"
             onclick="clickedOn(this.id)">
        </div>
      `;
          }
        }
        document.getElementById("0").classList.add("castle");
        document.getElementById("1").classList.add("horse");
        document.getElementById("2").classList.add("bishop");
        document.getElementById("3").classList.add("king");
        document.getElementById("4").classList.add("queen");
        document.getElementById("5").classList.add("bishop");
        document.getElementById("6").classList.add("horse");
        document.getElementById("7").classList.add("castle");
        for (let i = 8; i < 16; i++) {
          document.getElementById(`${i}`).classList.add("pawn");
        }
      }

      makeBoard();
    </script>
  </body>
</html>
